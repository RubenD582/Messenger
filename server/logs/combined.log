{"level":"error","message":"Error during logout: redisClient.sadd is not a function","stack":"TypeError: redisClient.sadd is not a function\n    at /Users/rubendreyer/Projects/Messanger/server/routes/authentication.js:186:17\n    at Layer.handle [as handle_request] (/Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rubendreyer/Projects/Messanger/server/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-03-15T21:52:26.914Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1452","message":"Error during login: relation \"users\" does not exist","name":"error","position":"15","routine":"parserOpenTable","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/rubendreyer/Projects/Messenger/server/node_modules/pg/lib/client.js:545:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/rubendreyer/Projects/Messenger/server/routes/authentication.js:134:20","timestamp":"2025-03-24T00:10:57.314Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1452","message":"Error during login: relation \"users\" does not exist","name":"error","position":"15","routine":"parserOpenTable","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/rubendreyer/Projects/Messenger/server/node_modules/pg/lib/client.js:545:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/rubendreyer/Projects/Messenger/server/routes/authentication.js:134:20","timestamp":"2025-03-24T00:11:15.745Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1452","message":"Error during login: relation \"users\" does not exist","name":"error","position":"15","routine":"parserOpenTable","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/rubendreyer/Projects/Messenger/server/node_modules/pg/lib/client.js:545:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/rubendreyer/Projects/Messenger/server/routes/authentication.js:134:20","timestamp":"2025-03-24T00:11:15.903Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1452","message":"Error during login: relation \"users\" does not exist","name":"error","position":"15","routine":"parserOpenTable","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/rubendreyer/Projects/Messenger/server/node_modules/pg/lib/client.js:545:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/rubendreyer/Projects/Messenger/server/routes/authentication.js:134:20","timestamp":"2025-03-24T00:11:16.088Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1452","message":"Error during login: relation \"users\" does not exist","name":"error","position":"15","routine":"parserOpenTable","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/rubendreyer/Projects/Messenger/server/node_modules/pg/lib/client.js:545:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/rubendreyer/Projects/Messenger/server/routes/authentication.js:134:20","timestamp":"2025-03-24T00:11:16.255Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1452","message":"Error during login: relation \"users\" does not exist","name":"error","position":"15","routine":"parserOpenTable","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/rubendreyer/Projects/Messenger/server/node_modules/pg/lib/client.js:545:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/rubendreyer/Projects/Messenger/server/routes/authentication.js:134:20","timestamp":"2025-03-24T00:13:31.871Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1466","message":"Error during login: relation \"users\" does not exist","name":"error","position":"15","routine":"parserOpenTable","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/pg/lib/client.js:545:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at async /Users/rubendreyer/Documents/Projects/Messenger/server/routes/authentication.js:136:20","timestamp":"2025-12-25T22:17:57.743Z"}
{"level":"error","message":"Error in /auth/clerk-signup: Cannot read properties of undefined (reading 'users')","stack":"TypeError: Cannot read properties of undefined (reading 'users')\n    at /Users/rubendreyer/Documents/Projects/Messenger/server/routes/authentication.js:253:36\n    at Layer.handle [as handle_request] (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:284:15\n    at router.process_params (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:280:10)\n    at router.handle (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-12-30T05:29:03.159Z"}
{"level":"error","message":"Error in /auth/clerk-signup: Cannot read properties of undefined (reading 'users')","stack":"TypeError: Cannot read properties of undefined (reading 'users')\n    at /Users/rubendreyer/Documents/Projects/Messenger/server/routes/authentication.js:253:36\n    at Layer.handle [as handle_request] (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:284:15\n    at router.process_params (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:280:10)\n    at router.handle (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/rubendreyer/Documents/Projects/Messenger/server/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-12-30T05:29:04.375Z"}
{"level":"warn","message":"SMTP credentials not configured. Using console logging for development.","timestamp":"2025-12-30T09:11:51.179Z"}
{"level":"warn","message":"SMTP credentials not configured. Using console logging for development.","timestamp":"2025-12-30T09:11:58.236Z"}
{"level":"warn","message":"SMTP credentials not configured. Using console logging for development.","timestamp":"2025-12-30T09:12:35.217Z"}
{"level":"warn","message":"SMTP credentials not configured. Using console logging for development.","timestamp":"2025-12-30T09:13:00.313Z"}
{"level":"warn","message":"SMTP credentials not configured. Using console logging for development.","timestamp":"2025-12-30T09:13:18.479Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:26:42.322Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:29:30.595Z"}
{"level":"info","message":"OTP generated (not logged for security)","timestamp":"2025-12-30T09:29:46.239Z"}
{"level":"error","message":"Error storing OTP: redisClient.setEx is not a function","stack":"TypeError: redisClient.setEx is not a function\n    at OTPService.storeOTP (/Users/rubendreyer/Documents/Projects/Messenger/server/services/otpService.js:95:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at async /Users/rubendreyer/Documents/Projects/Messenger/server/routes/authentication.js:251:25","timestamp":"2025-12-30T09:29:46.243Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:30:27.013Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:30:50.154Z"}
{"level":"info","message":"OTP generated (not logged for security)","timestamp":"2025-12-30T09:30:54.968Z"}
{"level":"error","message":"Error storing OTP: redisClient.setEx is not a function","stack":"TypeError: redisClient.setEx is not a function\n    at OTPService.incrementRateLimit (/Users/rubendreyer/Documents/Projects/Messenger/server/services/otpService.js:72:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at async OTPService.storeOTP (/Users/rubendreyer/Documents/Projects/Messenger/server/services/otpService.js:101:7)\n    at async /Users/rubendreyer/Documents/Projects/Messenger/server/routes/authentication.js:251:25","timestamp":"2025-12-30T09:30:54.976Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:33:29.609Z"}
{"level":"info","message":"OTP generated (not logged for security)","timestamp":"2025-12-30T09:33:31.513Z"}
{"level":"error","message":"Error storing OTP: redisClient.setEx is not a function","stack":"TypeError: redisClient.setEx is not a function\n    at OTPService.incrementRateLimit (/Users/rubendreyer/Documents/Projects/Messenger/server/services/otpService.js:72:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at async OTPService.storeOTP (/Users/rubendreyer/Documents/Projects/Messenger/server/services/otpService.js:101:7)\n    at async /Users/rubendreyer/Documents/Projects/Messenger/server/routes/authentication.js:251:25","timestamp":"2025-12-30T09:33:31.520Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:35:11.694Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:35:13.357Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:35:15.420Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:38:07.838Z"}
{"level":"info","message":"OTP generated (not logged for security)","timestamp":"2025-12-30T09:38:21.060Z"}
{"level":"info","message":"OTP stored for rdreyer523@gmail.com with purpose: registration","timestamp":"2025-12-30T09:38:21.068Z"}
{"level":"info","message":"OTP email sent to rdreyer523@gmail.com: <687a40c4-e417-8bd1-7df4-f2e92cff84ae@messenger.app>","timestamp":"2025-12-30T09:38:24.554Z"}
{"level":"error","message":"Error in /auth/register-with-email: redisClient.setEx is not a function","stack":"TypeError: redisClient.setEx is not a function\n    at /Users/rubendreyer/Documents/Projects/Messenger/server/routes/authentication.js:270:23\n    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)","timestamp":"2025-12-30T09:38:24.555Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:38:36.017Z"}
{"level":"info","message":"OTP generated (not logged for security)","timestamp":"2025-12-30T09:38:47.588Z"}
{"level":"info","message":"OTP stored for rdreyer523@gmail.com with purpose: registration","timestamp":"2025-12-30T09:38:47.593Z"}
{"level":"info","message":"OTP email sent to rdreyer523@gmail.com: <1a85639e-6f93-4b3b-f76a-fabb16b429d9@messenger.app>","timestamp":"2025-12-30T09:38:51.385Z"}
{"level":"error","message":"Error in /auth/register-with-email: redisClient.setEx is not a function","stack":"TypeError: redisClient.setEx is not a function\n    at /Users/rubendreyer/Documents/Projects/Messenger/server/routes/authentication.js:270:23\n    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)","timestamp":"2025-12-30T09:38:51.385Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:41:17.419Z"}
{"level":"info","message":"Email transporter initialized","timestamp":"2025-12-30T09:47:17.422Z"}
{"level":"info","message":"OTP generated (not logged for security)","timestamp":"2025-12-30T09:47:42.212Z"}
{"level":"info","message":"OTP stored for rdreyer523@gmail.com with purpose: registration","timestamp":"2025-12-30T09:47:42.218Z"}
{"level":"info","message":"OTP email sent to rdreyer523@gmail.com: <290e56da-72fd-d8aa-1231-3b835d3b084f@messenger.app>","timestamp":"2025-12-30T09:47:45.704Z"}
{"level":"info","message":"Registration OTP sent to: rdreyer523@gmail.com","timestamp":"2025-12-30T09:47:45.706Z"}
{"level":"warn","message":"Invalid OTP attempt for rdreyer523@gmail.com","timestamp":"2025-12-30T09:47:56.760Z"}
{"level":"info","message":"OTP deleted for rdreyer523@gmail.com","timestamp":"2025-12-30T09:48:18.799Z"}
{"level":"info","message":"OTP verified successfully for rdreyer523@gmail.com","timestamp":"2025-12-30T09:48:18.799Z"}
{"level":"info","message":"Email verified and user created: rdreyer523@gmail.com","timestamp":"2025-12-30T09:48:18.846Z"}
{"level":"info","message":"OTP generated (not logged for security)","timestamp":"2025-12-30T12:01:46.925Z"}
{"level":"info","message":"OTP stored for rdreyer523@gmail.com with purpose: 2fa","timestamp":"2025-12-30T12:01:46.935Z"}
{"level":"info","message":"OTP email sent to rdreyer523@gmail.com: <cd4b7711-c907-7e0b-17ff-d87f2a3c910a@messenger.app>","timestamp":"2025-12-30T12:01:50.843Z"}
{"level":"info","message":"OTP deleted for rdreyer523@gmail.com","timestamp":"2025-12-30T12:02:03.826Z"}
{"level":"info","message":"OTP verified successfully for rdreyer523@gmail.com","timestamp":"2025-12-30T12:02:03.827Z"}
{"level":"info","message":"2FA verified and user logged in: rdreyer523@gmail.com","timestamp":"2025-12-30T12:02:03.845Z"}
